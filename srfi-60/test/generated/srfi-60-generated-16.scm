(import (chibi) (chibi test) (srfi 60))

(test-begin "srfi-60/generated")

(test-begin "Bitwise Operations")

(test 128 (bitwise-and 26821 37024))
(test 42248 (bitwise-and 42282 42840))
(test -50652 (bitwise-and -49409 -1244))
(test 12800 (bitwise-and -19968 14158))
(test 33800 (bitwise-and 33822 54376))
(test 11264 (bitwise-and 60608 11827))
(test 1303 (bitwise-and -27369 3359))
(test 1099 (bitwise-and -2945 3659))
(test 1314 (bitwise-and -21210 21939))
(test -64511 (bitwise-and -55775 -58029))
(test 708 (bitwise-and 30446 -62780))
(test 63843 (bitwise-and 64499 63847))
(test 0 (bitwise-and -36300 35010))
(test 548 (bitwise-and 37542 27173))
(test -47096 (bitwise-and -42738 -37736))
(test 1542 (bitwise-and -63634 5639))
(test -65488 (bitwise-and -63624 -57167))
(test 16900 (bitwise-and 18023 27164))
(test -65535 (bitwise-and -63449 -61095))
(test 9484 (bitwise-and -51746 12077))
(test -60340 (bitwise-and -32900 -27570))
(test 18505 (bitwise-and 19401 -13187))
(test -46073 (bitwise-and -45657 -9209))
(test 37233 (bitwise-and -25223 45553))
(test -59735 (bitwise-and -49239 -59667))
(test 37248 (bitwise-and 62876 39361))
(test 5522 (bitwise-and 13715 40410))
(test 32820 (bitwise-and -8074 36541))
(test 864 (bitwise-and 24544 -23691))
(test 59396 (bitwise-and 59983 60836))
(test 8358 (bitwise-and 25790 11239))
(test -49024 (bitwise-and -14463 -48910))
(test 35082 (bitwise-and 36270 47962))
(test 17217 (bitwise-and 25417 20453))
(test 1286 (bitwise-and 15622 34238))
(test 16979 (bitwise-and -37285 49907))
(test 1152 (bitwise-and 40848 -64372))
(test 4144 (bitwise-and 4468 56498))
(test 20 (bitwise-and -64234 10836))
(test 10816 (bitwise-and -21650 15056))
(test 13585 (bitwise-and 62781 -51823))
(test 2052 (bitwise-and 52748 2277))
(test 4368 (bitwise-and 55063 -50768))
(test 49808 (bitwise-and -7528 57078))
(test 18708 (bitwise-and -46763 32020))
(test 1384 (bitwise-and -27288 26479))
(test 8261 (bitwise-and -55337 30829))
(test 1105 (bitwise-and -58159 42327))
(test -64494 (bitwise-and -31270 -37321))
(test 2056 (bitwise-and 18796 39433))

(test -13858 (bitwise-ior -32318 -47076))
(test -53331 (bitwise-ior 10760 -61531))
(test -2166 (bitwise-ior -39038 -10486))
(test -12417 (bitwise-ior -46273 50257))
(test -121 (bitwise-ior 64135 -18557))
(test 64954 (bitwise-ior 44426 55610))
(test -35313 (bitwise-ior -40434 -52215))
(test -51206 (bitwise-ior -55430 5258))
(test 57326 (bitwise-ior 38158 23266))
(test -2582 (bitwise-ior 9642 -4000))
(test -16421 (bitwise-ior -20519 -25062))
(test -16514 (bitwise-ior 13950 -21686))
(test -12290 (bitwise-ior -15770 36316))
(test -2085 (bitwise-ior -7718 22169))
(test -2756 (bitwise-ior -35532 32808))
(test -16388 (bitwise-ior -17040 46012))
(test -36866 (bitwise-ior 28114 -39044))
(test -1220 (bitwise-ior 23096 -5828))
(test 39899 (bitwise-ior 38987 37842))
(test -16389 (bitwise-ior -22022 -26695))
(test -41809 (bitwise-ior -58193 -47964))
(test 38655 (bitwise-ior 33483 38077))
(test -9737 (bitwise-ior -15977 -59292))
(test 27390 (bitwise-ior 27340 10426))
(test 65317 (bitwise-ior 14625 63236))
(test -33537 (bitwise-ior -33569 -64267))
(test -17441 (bitwise-ior -17636 -56361))
(test -33035 (bitwise-ior 5845 -33248))
(test 24511 (bitwise-ior 2747 24502))
(test -16441 (bitwise-ior -63801 47430))
(test -8195 (bitwise-ior 23444 -31123))
(test 65471 (bitwise-ior 61119 45954))
(test -33107 (bitwise-ior 22189 -54652))
(test -36097 (bitwise-ior -60891 -36614))
(test -2369 (bitwise-ior 38573 -4033))
(test -24581 (bitwise-ior -30981 6978))
(test -6411 (bitwise-ior -22976 -40203))
(test -5125 (bitwise-ior -5669 11001))
(test -25611 (bitwise-ior -26191 -60811))
(test -2833 (bitwise-ior 57442 -52049))
(test 65518 (bitwise-ior 48840 59886))
(test -43026 (bitwise-ior 21326 -64086))
(test -24626 (bitwise-ior -30770 6346))
(test -130 (bitwise-ior 63766 -16772))
(test -961 (bitwise-ior -33772 57387))
(test 32767 (bitwise-ior 23254 16313))
(test -38790 (bitwise-ior 26680 -55214))
(test 48628 (bitwise-ior 1392 48564))
(test -4135 (bitwise-ior 11728 -15463))
(test -33805 (bitwise-ior -44062 -55021))

(test -57945 (bitwise-xor -26726 35389))
(test 42919 (bitwise-xor -23762 -64375))
(test -50250 (bitwise-xor -64792 14686))
(test 13295 (bitwise-xor 53538 58061))
(test -54356 (bitwise-xor -48819 27361))
(test -46355 (bitwise-xor 14524 -36271))
(test 5160 (bitwise-xor 41008 46104))
(test 17606 (bitwise-xor -18651 -3101))
(test -25342 (bitwise-xor -19307 10647))
(test 58519 (bitwise-xor -24452 -47893))
(test 7709 (bitwise-xor 15993 8292))
(test 38010 (bitwise-xor 63952 28074))
(test 22098 (bitwise-xor -14220 -25050))
(test 55121 (bitwise-xor 10547 65122))
(test -22614 (bitwise-xor -41615 64219))
(test -15789 (bitwise-xor 40179 -41312))
(test 8165 (bitwise-xor 12951 11634))
(test 46575 (bitwise-xor 445 46162))
(test 45406 (bitwise-xor -22453 -59115))
(test -53553 (bitwise-xor -52801 8048))
(test 34933 (bitwise-xor -61610 -30941))
(test -64942 (bitwise-xor 57214 -8916))
(test 31325 (bitwise-xor -53246 -46497))
(test 27980 (bitwise-xor 30044 6160))
(test 62978 (bitwise-xor 14626 53024))
(test 26836 (bitwise-xor -54820 -48888))
(test 35895 (bitwise-xor -1940 -35749))
(test -43810 (bitwise-xor 53805 -30989))
(test -55349 (bitwise-xor 44006 -29651))
(test -54293 (bitwise-xor 37240 -17773))
(test 53237 (bitwise-xor 37120 24309))
(test 28777 (bitwise-xor 46137 50256))
(test -50607 (bitwise-xor -55573 7354))
(test 63422 (bitwise-xor 63099 453))
(test -34550 (bitwise-xor 5259 -37503))
(test -54995 (bitwise-xor -62005 9446))
(test -42583 (bitwise-xor 50231 -25186))
(test 14012 (bitwise-xor -12544 -1604))
(test 51 (bitwise-xor 37232 37187))
(test -9148 (bitwise-xor 27986 -20202))
(test 6041 (bitwise-xor -22960 -20023))
(test -22290 (bitwise-xor 63161 -41385))
(test -18178 (bitwise-xor -61020 43354))
(test -55876 (bitwise-xor -7066 49626))
(test 9809 (bitwise-xor -50656 -58255))
(test -44448 (bitwise-xor 44148 -492))
(test 35105 (bitwise-xor -26848 -57855))
(test 32140 (bitwise-xor -52103 -46603))
(test -18856 (bitwise-xor 22036 -8116))
(test 25754 (bitwise-xor -22281 -13203))

(test -10449 (bitwise-not 10448))
(test 11532 (bitwise-not -11533))
(test -12300 (bitwise-not 12299))
(test -19122 (bitwise-not 19121))
(test 6109 (bitwise-not -6110))
(test -14795 (bitwise-not 14794))
(test 27634 (bitwise-not -27635))
(test -30623 (bitwise-not 30622))
(test 58621 (bitwise-not -58622))
(test -49852 (bitwise-not 49851))
(test 1902 (bitwise-not -1903))
(test 39162 (bitwise-not -39163))
(test 1169 (bitwise-not -1170))
(test 45560 (bitwise-not -45561))
(test 1476 (bitwise-not -1477))
(test 40649 (bitwise-not -40650))
(test 26895 (bitwise-not -26896))
(test -18671 (bitwise-not 18670))
(test 46233 (bitwise-not -46234))
(test -27068 (bitwise-not 27067))
(test 13054 (bitwise-not -13055))
(test 5711 (bitwise-not -5712))
(test 3552 (bitwise-not -3553))
(test -16751 (bitwise-not 16750))
(test -30127 (bitwise-not 30126))
(test -63342 (bitwise-not 63341))
(test -42886 (bitwise-not 42885))
(test -55018 (bitwise-not 55017))
(test 50561 (bitwise-not -50562))
(test 38639 (bitwise-not -38640))
(test -34654 (bitwise-not 34653))
(test 42660 (bitwise-not -42661))
(test -59362 (bitwise-not 59361))
(test -65509 (bitwise-not 65508))
(test 20341 (bitwise-not -20342))
(test -63457 (bitwise-not 63456))
(test -20119 (bitwise-not 20118))
(test 29430 (bitwise-not -29431))
(test 2767 (bitwise-not -2768))
(test -62324 (bitwise-not 62323))
(test 28861 (bitwise-not -28862))
(test -30150 (bitwise-not 30149))
(test 14738 (bitwise-not -14739))
(test 40557 (bitwise-not -40558))
(test -7482 (bitwise-not 7481))
(test 4325 (bitwise-not -4326))
(test -27045 (bitwise-not 27044))
(test 43718 (bitwise-not -43719))
(test 29172 (bitwise-not -29173))
(test 14889 (bitwise-not -14890))

(test 6458 (bitwise-if -60488 37240 2098))
(test -26540 (bitwise-if -62428 -26220 38004))
(test -57850 (bitwise-if -58783 -42214 1063))
(test 47555 (bitwise-if 64735 -17981 55641))
(test 41638 (bitwise-if -22963 41764 -64337))
(test 45940 (bitwise-if 33171 45944 13302))
(test 19040 (bitwise-if -1559 19574 -1119))
(test 987 (bitwise-if 47539 -64621 2763))
(test -13471 (bitwise-if -44894 -13712 -9277))
(test 18592 (bitwise-if -6819 21024 -46615))
(test 9438 (bitwise-if 58840 -53509 50518))
(test -18868 (bitwise-if 20551 -49164 -2549))
(test 35985 (bitwise-if 62622 -31312 3201))
(test 36558 (bitwise-if -27162 61142 -62840))
(test -46142 (bitwise-if 49053 -46174 -34234))
(test 11059 (bitwise-if -7439 14131 59859))
(test 43345 (bitwise-if -2265 43417 32371))
(test 37109 (bitwise-if -63176 53362 -26379))
(test -21890 (bitwise-if 49074 -5510 -49716))
(test 21121 (bitwise-if 50360 25543 22073))
(test 10065 (bitwise-if 12384 -40740 5969))
(test -21127 (bitwise-if 52541 44921 -8115))
(test -4204 (bitwise-if -57959 -61456 -1259))
(test 32841 (bitwise-if 20142 -57063 33347))
(test -13029 (bitwise-if 22440 19742 -28781))
(test 55269 (bitwise-if -2497 54885 46017))
(test 2626 (bitwise-if -32926 2642 16930))
(test 19329 (bitwise-if -1358 20108 53523))
(test -7550 (bitwise-if -41712 -48534 -23934))
(test -34437 (bitwise-if 43758 -37510 -11431))
(test -15371 (bitwise-if -45935 -36367 -29707))
(test -54459 (bitwise-if 38255 453 -50399))
(test 36939 (bitwise-if -17268 54059 -53053))
(test -57935 (bitwise-if 14804 7057 -57867))
(test 6463 (bitwise-if -64372 18511 -58945))
(test -37719 (bitwise-if 43676 14571 -45535))
(test -15671 (bitwise-if 10836 -60736 -6007))
(test 10200 (bitwise-if 10557 -35366 1993))
(test -64049 (bitwise-if -18214 -48438 46535))
(test 58701 (bitwise-if -1702 58856 34053))
(test 51704 (bitwise-if 19962 31740 32784))
(test -3011 (bitwise-if -34334 -2527 -929))
(test 6621 (bitwise-if 920 35224 6605))
(test 53894 (bitwise-if 22112 23190 32902))
(test -10177 (bitwise-if -19297 -28033 22703))
(test -54269 (bitwise-if 13607 -53549 -63484))
(test -55224 (bitwise-if -55542 -51047 -63416))
(test -24835 (bitwise-if -31617 -31363 40700))
(test -30544 (bitwise-if 45626 -31436 -18262))
(test -36354 (bitwise-if 32343 -3978 -50691))

(test #t (any-bits-set? -40528 -36061))
(test #t (any-bits-set? 27730 60223))
(test #t (any-bits-set? -40083 14419))
(test #t (any-bits-set? 51739 -18860))
(test #t (any-bits-set? 23612 -14015))
(test #t (any-bits-set? -39662 16228))
(test #t (any-bits-set? -45272 17296))
(test #t (any-bits-set? 44581 -63021))
(test #t (any-bits-set? -43468 -48221))
(test #t (any-bits-set? 56864 -580))
(test #t (any-bits-set? 37454 -58848))
(test #t (any-bits-set? -43328 -17290))
(test #t (any-bits-set? 12770 14830))
(test #t (any-bits-set? -2974 27297))
(test #t (any-bits-set? 54232 11747))
(test #t (any-bits-set? -17649 -8114))
(test #t (any-bits-set? -30802 -17411))
(test #t (any-bits-set? -27831 -65235))
(test #t (any-bits-set? -44483 -30991))
(test #t (any-bits-set? 38270 -41383))
(test #t (any-bits-set? -37032 51636))
(test #t (any-bits-set? -29277 48160))
(test #t (any-bits-set? 27129 -45032))
(test #t (any-bits-set? -64476 19709))
(test #t (any-bits-set? -40089 7577))
(test #t (any-bits-set? 46952 2370))
(test #t (any-bits-set? -19117 -9575))
(test #t (any-bits-set? 43817 -15688))
(test #t (any-bits-set? 44342 -24537))
(test #t (any-bits-set? 60528 24627))
(test #t (any-bits-set? 16931 -59760))
(test #t (any-bits-set? -17732 -62014))
(test #t (any-bits-set? -43961 55117))
(test #t (any-bits-set? 41797 -30126))
(test #t (any-bits-set? 62793 21461))
(test #t (any-bits-set? -37346 -27456))
(test #t (any-bits-set? -55293 -4406))
(test #t (any-bits-set? 52345 34427))
(test #t (any-bits-set? -3068 -6833))
(test #t (any-bits-set? -8544 54921))
(test #t (any-bits-set? -33980 1950))
(test #t (any-bits-set? 48035 46545))
(test #t (any-bits-set? 28953 63964))
(test #t (any-bits-set? 30135 -60443))
(test #t (any-bits-set? 32929 -6502))
(test #t (any-bits-set? -8725 -26932))
(test #t (any-bits-set? 35119 -62686))
(test #t (any-bits-set? 47536 -52239))
(test #f (any-bits-set? 8284 2945))
(test #t (any-bits-set? 14813 37399))

(test-end)

(test-begin "Integer Properties")

(test 10 (bit-count 50591))
(test 10 (bit-count -18420))
(test 13 (bit-count -30208))
(test 8 (bit-count 39705))
(test 7 (bit-count -24001))
(test 8 (bit-count 19180))
(test 8 (bit-count -24134))
(test 9 (bit-count -30232))
(test 6 (bit-count -21605))
(test 7 (bit-count -756))
(test 9 (bit-count 38119))
(test 9 (bit-count 25319))
(test 8 (bit-count -25480))
(test 7 (bit-count 37427))
(test 9 (bit-count -22389))
(test 11 (bit-count -44780))
(test 5 (bit-count -5380))
(test 8 (bit-count -20389))
(test 10 (bit-count 7899))
(test 8 (bit-count -48419))
(test 5 (bit-count 21540))
(test 7 (bit-count -55465))
(test 7 (bit-count 20819))
(test 4 (bit-count -6337))
(test 9 (bit-count 39402))
(test 3 (bit-count -33027))
(test 6 (bit-count 42184))
(test 6 (bit-count -22566))
(test 6 (bit-count -50244))
(test 11 (bit-count -31222))
(test 13 (bit-count 63223))
(test 9 (bit-count -55078))
(test 10 (bit-count -39923))
(test 11 (bit-count 49122))
(test 13 (bit-count 59135))
(test 5 (bit-count 6248))
(test 10 (bit-count -14062))
(test 14 (bit-count -16384))
(test 9 (bit-count 61862))
(test 10 (bit-count 52598))
(test 8 (bit-count 11729))
(test 11 (bit-count 28150))
(test 8 (bit-count -36690))
(test 9 (bit-count 55851))
(test 5 (bit-count 55300))
(test 10 (bit-count 44878))
(test 5 (bit-count -18627))
(test 9 (bit-count 58723))
(test 7 (bit-count 37094))
(test 12 (bit-count 32756))

(test 15 (integer-length -20803))
(test 14 (integer-length 11456))
(test 16 (integer-length 51383))
(test 16 (integer-length 44420))
(test 15 (integer-length -21903))
(test 13 (integer-length 6700))
(test 14 (integer-length 9610))
(test 16 (integer-length -52864))
(test 15 (integer-length -29150))
(test 16 (integer-length 33180))
(test 16 (integer-length -61373))
(test 16 (integer-length 41194))
(test 15 (integer-length 22408))
(test 14 (integer-length 14288))
(test 14 (integer-length -15699))
(test 16 (integer-length -60254))
(test 16 (integer-length 57797))
(test 16 (integer-length -35497))
(test 13 (integer-length 4439))
(test 15 (integer-length -32464))
(test 14 (integer-length -13604))
(test 11 (integer-length -1817))
(test 12 (integer-length 2779))
(test 14 (integer-length -14777))
(test 16 (integer-length 57860))
(test 16 (integer-length 36997))
(test 13 (integer-length -7513))
(test 16 (integer-length -58201))
(test 16 (integer-length -61539))
(test 16 (integer-length 64709))
(test 16 (integer-length 62584))
(test 15 (integer-length 28592))
(test 14 (integer-length -9000))
(test 15 (integer-length 28540))
(test 10 (integer-length -1012))
(test 15 (integer-length -27382))
(test 14 (integer-length 10139))
(test 15 (integer-length -30317))
(test 15 (integer-length -23375))
(test 16 (integer-length -43854))
(test 15 (integer-length 16624))
(test 16 (integer-length -33253))
(test 15 (integer-length 21999))
(test 15 (integer-length -28989))
(test 16 (integer-length 37879))
(test 15 (integer-length -20334))
(test 16 (integer-length 60357))
(test 14 (integer-length 10684))
(test 6 (integer-length -43))
(test 16 (integer-length -45094))

(test 0 (first-set-bit 58763))
(test 0 (first-set-bit -24919))
(test 0 (first-set-bit -63195))
(test 1 (first-set-bit -56654))
(test 0 (first-set-bit 34455))
(test 4 (first-set-bit 31984))
(test 0 (first-set-bit -34041))
(test 1 (first-set-bit -34714))
(test 0 (first-set-bit -14317))
(test 0 (first-set-bit 64099))
(test 6 (first-set-bit -41024))
(test 1 (first-set-bit -24342))
(test 2 (first-set-bit -17404))
(test 0 (first-set-bit -37503))
(test 3 (first-set-bit -21720))
(test 2 (first-set-bit 36692))
(test 3 (first-set-bit 40360))
(test 0 (first-set-bit 65201))
(test 1 (first-set-bit -40858))
(test 0 (first-set-bit -50281))
(test 2 (first-set-bit 27772))
(test 0 (first-set-bit -17087))
(test 4 (first-set-bit -33136))
(test 1 (first-set-bit 57818))
(test 0 (first-set-bit 15355))
(test 1 (first-set-bit 62694))
(test 0 (first-set-bit -51281))
(test 2 (first-set-bit -18140))
(test 1 (first-set-bit 43390))
(test 1 (first-set-bit -8378))
(test 3 (first-set-bit -13176))
(test 0 (first-set-bit -23331))
(test 0 (first-set-bit 15195))
(test 0 (first-set-bit -24121))
(test 3 (first-set-bit -32840))
(test 2 (first-set-bit 50300))
(test 3 (first-set-bit -11912))
(test 0 (first-set-bit -17553))
(test 3 (first-set-bit -10184))
(test 3 (first-set-bit -4248))
(test 0 (first-set-bit -29655))
(test 0 (first-set-bit 16959))
(test 0 (first-set-bit 56643))
(test 1 (first-set-bit -54718))
(test 0 (first-set-bit -7757))
(test 1 (first-set-bit -44854))
(test 0 (first-set-bit -23671))
(test 0 (first-set-bit 2769))
(test 1 (first-set-bit -51206))
(test 3 (first-set-bit -32184))

(test-end)

(test-begin "Bit Within Word")

(test #t (bit-set? 2 18213))
(test #t (bit-set? 9 25228))
(test #f (bit-set? 14 -61679))
(test #f (bit-set? 10 47598))
(test #f (bit-set? 14 11181))
(test #f (bit-set? 5 46038))
(test #t (bit-set? 9 -44127))
(test #t (bit-set? 8 7602))
(test #t (bit-set? 5 26227))
(test #f (bit-set? 0 -58720))
(test #f (bit-set? 9 -58977))
(test #f (bit-set? 12 4055))
(test #t (bit-set? 7 -13127))
(test #t (bit-set? 11 40932))
(test #f (bit-set? 12 49399))
(test #f (bit-set? 5 -59427))
(test #f (bit-set? 4 20041))
(test #f (bit-set? 10 -17436))
(test #f (bit-set? 15 23360))
(test #t (bit-set? 14 -47929))
(test #f (bit-set? 0 -37326))
(test #t (bit-set? 9 24437))
(test #f (bit-set? 13 39111))
(test #f (bit-set? 14 -64608))
(test #f (bit-set? 13 38075))
(test #t (bit-set? 15 -10202))
(test #f (bit-set? 11 54170))
(test #f (bit-set? 0 -37144))
(test #t (bit-set? 3 -62673))
(test #t (bit-set? 10 40397))
(test #f (bit-set? 3 -20057))
(test #f (bit-set? 1 31128))
(test #t (bit-set? 6 -40504))
(test #f (bit-set? 2 35074))
(test #f (bit-set? 7 28929))
(test #t (bit-set? 9 -37260))
(test #t (bit-set? 15 58508))
(test #t (bit-set? 6 -21136))
(test #t (bit-set? 13 -22763))
(test #t (bit-set? 2 3852))
(test #t (bit-set? 12 -24962))
(test #t (bit-set? 9 22021))
(test #f (bit-set? 1 30632))
(test #t (bit-set? 13 46703))
(test #f (bit-set? 6 3205))
(test #t (bit-set? 15 59921))
(test #f (bit-set? 6 -47043))
(test #f (bit-set? 8 -55737))
(test #f (bit-set? 5 -27451))
(test #t (bit-set? 8 41787))

(test -36012 (copy-bit 13 -36012 #t))
(test -46354 (copy-bit 11 -48402 #t))
(test -30251 (copy-bit 8 -30251 #t))
(test -30959 (copy-bit 15 -63727 #t))
(test -25247 (copy-bit 12 -25247 #t))
(test -27797 (copy-bit 1 -27797 #t))
(test -9969 (copy-bit 11 -12017 #t))
(test -40841 (copy-bit 3 -40841 #f))
(test 25062 (copy-bit 15 25062 #f))
(test 4937 (copy-bit 6 4873 #t))
(test -3830 (copy-bit 8 -4086 #t))
(test 41137 (copy-bit 13 32945 #t))
(test 63263 (copy-bit 6 63263 #f))
(test -40201 (copy-bit 10 -39177 #f))
(test -39266 (copy-bit 6 -39266 #f))
(test 60200 (copy-bit 5 60200 #t))
(test -58387 (copy-bit 13 -58387 #f))
(test 24389 (copy-bit 4 24389 #f))
(test -8486 (copy-bit 10 -8486 #t))
(test 26037 (copy-bit 6 26037 #f))
(test 30233 (copy-bit 15 63001 #f))
(test 61349 (copy-bit 15 61349 #t))
(test 28070 (copy-bit 6 28134 #f))
(test 38211 (copy-bit 14 38211 #f))
(test 57429 (copy-bit 7 57557 #f))
(test 52458 (copy-bit 10 52458 #t))
(test 17517 (copy-bit 2 17517 #t))
(test -57399 (copy-bit 3 -57407 #t))
(test 50043 (copy-bit 7 50043 #f))
(test 43476 (copy-bit 9 43988 #f))
(test 14779 (copy-bit 9 15291 #f))
(test 39428 (copy-bit 2 39428 #t))
(test -62783 (copy-bit 7 -62911 #t))
(test 49506 (copy-bit 7 49506 #f))
(test -5358 (copy-bit 10 -5358 #f))
(test 11020 (copy-bit 0 11020 #f))
(test -28965 (copy-bit 6 -29029 #t))
(test -18710 (copy-bit 2 -18710 #f))
(test 40242 (copy-bit 5 40210 #t))
(test -39980 (copy-bit 2 -39980 #t))
(test -31243 (copy-bit 10 -31243 #t))
(test -64500 (copy-bit 4 -64500 #f))
(test -55200 (copy-bit 8 -55200 #f))
(test -44966 (copy-bit 5 -44966 #f))
(test 11422 (copy-bit 14 11422 #f))
(test 52096 (copy-bit 7 51968 #t))
(test 57030 (copy-bit 14 40646 #t))
(test 39436 (copy-bit 11 39436 #t))
(test -60956 (copy-bit 12 -65052 #t))
(test -26325 (copy-bit 6 -26261 #f))

(test-end)

(test-begin "Field of Bits")

(test 379 (bit-field -45586 2 11))
(test 1281 (bit-field 2563 1 15))
(test 45 (bit-field -41546 2 8))
(test 0 (bit-field 39036 7 8))
(test 46 (bit-field -29235 5 11))
(test 98 (bit-field -52925 7 14))
(test 1 (bit-field 19087 7 9))
(test 27 (bit-field 50042 5 11))
(test 215 (bit-field 1454 1 10))
(test 58 (bit-field -30901 5 12))
(test 879 (bit-field -8772 2 12))
(test 1251 (bit-field 11491 0 11))
(test 2 (bit-field 23221 8 10))
(test 4 (bit-field -48622 7 11))
(test 4 (bit-field 45645 7 10))
(test 9557 (bit-field -55979 0 14))
(test 2756 (bit-field 22049 3 15))
(test 95 (bit-field 11966 1 9))
(test 243 (bit-field -17194 6 14))
(test 124 (bit-field 33265 2 15))
(test 1881 (bit-field 47819 3 15))
(test 32 (bit-field -64510 5 15))
(test 7676 (bit-field -57860 0 14))
(test 1855 (bit-field -49345 0 11))
(test 16 (bit-field -47870 4 10))
(test 1 (bit-field -31145 6 9))
(test 3 (bit-field -47195 8 10))
(test 10 (bit-field 19106 4 8))
(test 16178 (bit-field 32562 0 14))
(test 232 (bit-field -45435 4 13))
(test 317 (bit-field 3389 0 10))
(test 79 (bit-field -56079 4 11))
(test 184 (bit-field -47678 3 11))
(test 0 (bit-field -45700 7 8))
(test 72 (bit-field 50321 1 9))
(test 369 (bit-field 28198 5 14))
(test 240 (bit-field -65056 1 10))
(test 288 (bit-field 49728 1 14))
(test 42 (bit-field 19498 0 8))
(test 9 (bit-field 28824 4 11))
(test 30 (bit-field 51127 6 12))
(test 6706 (bit-field -26062 0 14))
(test 7 (bit-field -48671 6 11))
(test 5 (bit-field -7540 7 13))
(test 167 (bit-field -32099 2 12))
(test 54 (bit-field 34508 5 13))
(test 51 (bit-field -58928 7 15))
(test 9 (bit-field 18576 4 9))
(test 426 (bit-field 426 0 12))
(test 14 (bit-field -58934 5 9))

(test 55054 (copy-bit-field 61710 -25897 8 14))
(test 42875 (copy-bit-field 47291 -55907 6 14))
(test 33453 (copy-bit-field 48949 -65194 1 15))
(test -8815 (copy-bit-field -8735 -48743 4 8))
(test 2601 (copy-bit-field 2529 44613 3 11))
(test 2084 (copy-bit-field 3584 -62967 2 13))
(test 40038 (copy-bit-field 40174 35468 3 10))
(test -59346 (copy-bit-field -58923 60462 0 10))
(test 38996 (copy-bit-field 34032 5653 2 13))
(test -28631 (copy-bit-field -28119 2096 8 13))
(test -25303 (copy-bit-field -25559 -25815 8 10))
(test 38658 (copy-bit-field 36946 -50064 4 11))
(test 50604 (copy-bit-field 50348 -32523 8 11))
(test 15447 (copy-bit-field 15383 -10662 5 8))
(test -40009 (copy-bit-field -40181 53485 2 8))
(test 7292 (copy-bit-field 7676 -61855 6 9))
(test -14135 (copy-bit-field -14136 -41527 0 8))
(test -6025 (copy-bit-field -6025 29084 8 8))
(test 28505 (copy-bit-field 24281 -32011 4 14))
(test -3891 (copy-bit-field -3955 -3954 5 8))
(test 18445 (copy-bit-field 18509 4728 6 9))
(test -5461 (copy-bit-field -565 -6059 5 13))
(test 56620 (copy-bit-field 56812 60456 6 8))
(test 39199 (copy-bit-field 35615 31481 8 13))
(test -63130 (copy-bit-field -63178 -64778 4 9))
(test -44560 (copy-bit-field -44928 -38017 4 9))
(test -40661 (copy-bit-field -40821 7657 5 10))
(test -8944 (copy-bit-field -8580 -2936 1 10))
(test -65106 (copy-bit-field -65246 57559 1 12))
(test -34865 (copy-bit-field -36529 -51217 7 12))
(test 36784 (copy-bit-field 36848 -6693 4 9))
(test -46906 (copy-bit-field -46906 4168 8 10))
(test -17420 (copy-bit-field -17460 -39938 3 9))
(test -41795 (copy-bit-field -43295 13918 1 12))
(test -40495 (copy-bit-field -50325 -3864 1 15))
(test -17936 (copy-bit-field -17120 -11361 4 15))
(test -57112 (copy-bit-field -57304 -36748 1 10))
(test 64841 (copy-bit-field 64969 -28006 7 12))
(test -24587 (copy-bit-field -8011 -32641 6 15))
(test 27712 (copy-bit-field 28614 42016 1 10))
(test -61696 (copy-bit-field -38656 40508 6 15))
(test -30533 (copy-bit-field -30661 30917 5 8))
(test 37437 (copy-bit-field 38169 26255 2 11))
(test -5251 (copy-bit-field -4177 34238 1 13))
(test -42874 (copy-bit-field -43002 -18135 7 9))
(test 1114 (copy-bit-field 12698 36933 4 15))
(test 29779 (copy-bit-field 29651 -23944 7 11))
(test 7490 (copy-bit-field 7362 -7499 6 9))
(test 22340 (copy-bit-field 22212 36029 6 10))
(test -8185 (copy-bit-field -7929 20488 8 10))

(test 0 (arithmetic-shift 37860 -16))
(test 781760 (arithmetic-shift 48860 4))
(test -4237688832 (arithmetic-shift -64662 16))
(test 729664 (arithmetic-shift 45604 4))
(test -88096768 (arithmetic-shift -10754 13))
(test 5158 (arithmetic-shift 20635 -2))
(test 2358784 (arithmetic-shift 36856 6))
(test -433320 (arithmetic-shift -54165 3))
(test 0 (arithmetic-shift 23551 -18))
(test -60 (arithmetic-shift -60724 -10))
(test 715063296 (arithmetic-shift 10911 16))
(test 0 (arithmetic-shift 4546 -14))
(test 3 (arithmetic-shift 1952 -9))
(test -1 (arithmetic-shift -6515 -16))
(test 85 (arithmetic-shift 2749 -5))
(test -778480 (arithmetic-shift -48655 4))
(test -244 (arithmetic-shift -7792 -5))
(test 99 (arithmetic-shift 25562 -8))
(test -1011120 (arithmetic-shift -63195 4))
(test -2643 (arithmetic-shift -42288 -4))
(test 72424 (arithmetic-shift 18106 2))
(test -42285056 (arithmetic-shift -20647 11))
(test -4 (arithmetic-shift -29246 -13))
(test -81 (arithmetic-shift -10303 -7))
(test 225812480 (arithmetic-shift 55130 12))
(test 1 (arithmetic-shift 18583 -14))
(test -25457152 (arithmetic-shift -49721 9))
(test -1 (arithmetic-shift -45708 -16))
(test -9733632 (arithmetic-shift -19011 9))
(test 0 (arithmetic-shift 26383 -17))
(test 153088000 (arithmetic-shift 37375 12))
(test -71 (arithmetic-shift -283 -2))
(test 8098176 (arithmetic-shift 63267 7))
(test -2080 (arithmetic-shift -33274 -4))
(test 0 (arithmetic-shift 9366 -14))
(test -7 (arithmetic-shift -14044 -11))
(test -1840 (arithmetic-shift -29436 -4))
(test -178344 (arithmetic-shift -44586 2))
(test 185 (arithmetic-shift 47471 -8))
(test -714944 (arithmetic-shift -44684 4))
(test -4 (arithmetic-shift -56453 -14))
(test 54 (arithmetic-shift 55968 -10))
(test 7278821376 (arithmetic-shift 55533 17))
(test 216448 (arithmetic-shift 13528 4))
(test 5673 (arithmetic-shift 11347 -1))
(test 441647104 (arithmetic-shift 26956 14))
(test -15 (arithmetic-shift -29728 -11))
(test 0 (arithmetic-shift 875 -14))
(test -26 (arithmetic-shift -51542 -11))
(test -36 (arithmetic-shift -35950 -10))

(test 62646 (rotate-bit-field 58810 9 2 14))
(test 8210 (rotate-bit-field 8226 11 4 10))
(test -5581 (rotate-bit-field -5581 18 7 13))
(test -2912 (rotate-bit-field -2880 -5 5 8))
(test 54205 (rotate-bit-field 55101 4 7 12))
(test 18829 (rotate-bit-field 19213 11 5 11))
(test -2648 (rotate-bit-field -2648 18 4 13))
(test 63705 (rotate-bit-field 63705 5 7 12))
(test 15907 (rotate-bit-field 15431 8 1 10))
(test -15025 (rotate-bit-field -15057 -17 3 8))
(test 19250 (rotate-bit-field 19250 10 4 14))
(test -6543 (rotate-bit-field -12687 -14 5 14))
(test -44074 (rotate-bit-field -37578 4 4 15))
(test 3180 (rotate-bit-field 3180 -10 1 11))
(test 20205 (rotate-bit-field 19389 -2 4 11))
(test 18889 (rotate-bit-field 19015 -12 1 10))
(test -17221 (rotate-bit-field -17825 -8 2 11))
(test -42176 (rotate-bit-field -41664 1 8 12))
(test 49083 (rotate-bit-field 64251 16 5 15))
(test 30832 (rotate-bit-field 30734 14 0 11))
(test 22088 (rotate-bit-field 21800 13 4 10))
(test -10029 (rotate-bit-field -8685 -5 6 13))
(test -61190 (rotate-bit-field -61190 -17 4 8))
(test -40472 (rotate-bit-field -40817 -4 0 9))
(test 24989 (rotate-bit-field 19697 -15 2 14))
(test 46876 (rotate-bit-field 42439 2 0 13))
(test 3930 (rotate-bit-field 15450 -9 7 14))
(test -23803 (rotate-bit-field -21499 3 7 12))
(test -50199 (rotate-bit-field -49303 8 7 12))
(test -28417 (rotate-bit-field -28417 12 7 13))
(test -57914 (rotate-bit-field -57914 0 5 14))
(test 58300 (rotate-bit-field 58300 16 5 9))
(test 22329 (rotate-bit-field 22329 1 6 8))
(test -3363 (rotate-bit-field -26659 -3 6 15))
(test 3036 (rotate-bit-field 2934 7 1 10))
(test -48880 (rotate-bit-field -48880 5 5 10))
(test 9309 (rotate-bit-field 8413 15 7 11))
(test 27331 (rotate-bit-field 27331 10 1 11))
(test 6265 (rotate-bit-field 4345 9 7 12))
(test -22272 (rotate-bit-field -22464 -9 0 11))
(test 5574 (rotate-bit-field 11146 -13 2 14))
(test 31567 (rotate-bit-field 31567 -9 5 14))
(test -44275 (rotate-bit-field -44851 16 4 11))
(test -36757 (rotate-bit-field -35317 3 5 12))
(test 18341 (rotate-bit-field 18149 8 5 10))
(test -33978 (rotate-bit-field -33978 12 6 8))
(test 54786 (rotate-bit-field 54786 -8 6 10))
(test -45081 (rotate-bit-field -45081 8 7 10))
(test 8242 (rotate-bit-field 8386 16 4 10))
(test -51012 (rotate-bit-field -49620 2 3 14))

(test -55249 (reverse-bit-field -53439 0 12))
(test -5861 (reverse-bit-field -5711 0 9))
(test 17298 (reverse-bit-field 16974 2 9))
(test 55881 (reverse-bit-field 58518 0 14))
(test 32592 (reverse-bit-field 32592 7 8))
(test -22127 (reverse-bit-field -22959 6 12))
(test 53896 (reverse-bit-field 55816 7 12))
(test -48252 (reverse-bit-field -48612 1 11))
(test 12412 (reverse-bit-field 892 8 14))
(test 6260 (reverse-bit-field 1652 8 14))
(test -38346 (reverse-bit-field -39626 7 13))
(test -56395 (reverse-bit-field -55579 3 12))
(test -20761 (reverse-bit-field -28945 3 14))
(test 18011 (reverse-bit-field 27019 4 14))
(test 59002 (reverse-bit-field 60538 8 13))
(test -29447 (reverse-bit-field -29063 6 11))
(test -63859 (reverse-bit-field -59215 1 14))
(test 18917 (reverse-bit-field 18749 2 9))
(test -27021 (reverse-bit-field -25389 4 13))
(test -38821 (reverse-bit-field -37621 0 15))
(test -61394 (reverse-bit-field -61274 3 8))
(test 44816 (reverse-bit-field 33914 0 15))
(test 18678 (reverse-bit-field 20022 6 11))
(test -41923 (reverse-bit-field -42883 5 12))
(test -45033 (reverse-bit-field -44793 4 9))
(test 55153 (reverse-bit-field 53487 1 11))
(test 43705 (reverse-bit-field 48465 3 13))
(test -43592 (reverse-bit-field -38216 7 15))
(test -58826 (reverse-bit-field -54218 8 15))
(test -63660 (reverse-bit-field -64850 0 12))
(test -27808 (reverse-bit-field -28618 0 11))
(test 50488 (reverse-bit-field 54328 8 13))
(test -22043 (reverse-bit-field -22043 6 8))
(test 39145 (reverse-bit-field 40385 3 11))
(test 62015 (reverse-bit-field 65299 1 13))
(test 13864 (reverse-bit-field 13416 4 12))
(test -42964 (reverse-bit-field -42964 7 9))
(test -22174 (reverse-bit-field -22174 7 8))
(test -60091 (reverse-bit-field -59766 0 10))
(test 2972 (reverse-bit-field 2510 1 10))
(test -45844 (reverse-bit-field -45620 0 14))
(test 906 (reverse-bit-field 3210 8 12))
(test 56390 (reverse-bit-field 52806 8 14))
(test 32853 (reverse-bit-field 33045 6 9))
(test 22564 (reverse-bit-field 16804 5 15))
(test -49696 (reverse-bit-field -49913 0 8))
(test -58810 (reverse-bit-field -60730 6 13))
(test 64288 (reverse-bit-field 63136 7 12))
(test -17987 (reverse-bit-field -18819 6 12))
(test 63256 (reverse-bit-field 61912 4 13))

(test-end)

(test-begin "Bits as Booleans")

(test '(#f #t) (integer->list 5533 2))
(test '() (integer->list 17822 0))
(test '(#f #t #f #f #f) (integer->list 18536 5))
(test '(#f #t #f #t #f #t #f #f #f #t #f #t #f #f #f) (integer->list 10792 15))
(test '(#f #t #t #f #f #f #t #f #t #t #f) (integer->list 33558 11))
(test '(#f #f #f #t #t #f #t #f #f #t #t #f #t #f #t #f #t) (integer->list 13525 17))
(test '(#t #t #f #f #t #t) (integer->list 50995 6))
(test '(#f #f #t #t #t #t #t #f #t #f #t #f #t #f #t #t #t #t) (integer->list 64175 18))
(test '(#t #f #t #t #f #f #f #f #t) (integer->list 29537 9))
(test '(#t #f #t) (integer->list 58693 3))
(test '(#t #f #t #t #f #t #t #t #f #f #t #t #t) (integer->list 55015 13))
(test '(#t #t #t #f #t #t #f #f #t #f #f #f #f #t #f) (integer->list 63042 15))
(test '(#f) (integer->list 49374 1))
(test '(#f #t #t #t #f #f #f #f #t #t #t) (integer->list 37767 11))
(test '(#t #t) (integer->list 11 2))
(test '() (integer->list 47830 0))
(test '(#t #t #t #f #t #f #t #f #t) (integer->list 18901 9))
(test '(#f) (integer->list 59286 1))
(test '(#t #f #t #t #f #f) (integer->list 18348 6))
(test '(#t) (integer->list 17327 1))
(test '(#t #t #f #f #t #t #f #f #t #f) (integer->list 3890 10))
(test '(#f #f #f #f #f #t #f #t #t #f #t #f #f #f #t #t #f #f #t) (integer->list 11545 19))
(test '(#t #t) (integer->list 39823 2))
(test '(#f #t #f #f #t #t) (integer->list 49747 6))
(test '(#t #t #f #t #t #f #t #t #f #f #f #t) (integer->list 36273 12))
(test '(#f #t #f #t #t #t #t #t #t #f #f #f #t #t #t) (integer->list 12231 15))
(test '(#t #t #t #f) (integer->list 2334 4))
(test '(#f #f #f #f) (integer->list 560 4))
(test '(#f #t #f #f) (integer->list 32884 4))
(test '(#t #t #f #t #t) (integer->list 44411 5))
(test '(#f #f #t #t #t #t #f #t #f #t #f #f #f #t #t #t #f #t) (integer->list 62749 18))
(test '(#f #f #t #t #f #t #f #f #t #t #t #t #f #t #t #f #f) (integer->list 27116 17))
(test '(#f #f #f #f #t #f #f) (integer->list 64260 7))
(test '(#t #f #f #t #f #t #t #t #t #f #t) (integer->list 54461 11))
(test '(#f #f #t #t #t #f #f #t #f #t #t #f #t #f #f) (integer->list 7348 15))
(test '(#f #f #f #f #t #t #t #t #f #t #t #t #f #t #f #f #f #f #f) (integer->list 31648 19))
(test '(#f #f #t #t #f #f #t #t #f #f #t #t #f #f #t #f) (integer->list 13106 16))
(test '(#t #t #t #f) (integer->list 36910 4))
(test '(#f #t #f #f #t #t #t #f #t #f #t #f #f #t #f) (integer->list 42834 15))
(test '(#t #t #f #t #f #t #t #t #f) (integer->list 64430 9))
(test '(#f #f #f #t #f #f #f #f #f #t #f #f #f #t #f #t #f #t) (integer->list 16661 18))
(test '(#t #f #t #t) (integer->list 36427 4))
(test '(#f #f #f #t) (integer->list 40257 4))
(test '(#t #f #f #f #f #f #f) (integer->list 12352 7))
(test '(#t #f #t #t #t) (integer->list 19095 5))
(test '(#f #t #f #t #f #t #f #f) (integer->list 1108 8))
(test '(#f #t) (integer->list 55989 2))
(test '(#f #f #t #t #f #f #t #f #t #t #f #f #t #f #t #t #f) (integer->list 26006 17))
(test '(#t #f #t #t #f #t) (integer->list 52461 6))
(test '(#t #f #t #f #f #t #t #f #f #t #f #t #f #f #f) (integer->list 54056 15))

(test 0 (list->integer '()))
(test 543 (list->integer '(#t #f #f #f #f #t #t #t #t #t)))
(test 29 (list->integer '(#f #f #f #t #t #t #f #t)))
(test 2146 (list->integer '(#t #f #f #f #f #t #t #f #f #f #t #f)))
(test 24 (list->integer '(#t #t #f #f #f)))
(test 14 (list->integer '(#t #t #t #f)))
(test 3685 (list->integer '(#f #f #f #t #t #t #f #f #t #t #f #f #t #f #t)))
(test 1 (list->integer '(#t)))
(test 6417 (list->integer '(#t #t #f #f #t #f #f #f #t #f #f #f #t)))
(test 758 (list->integer '(#f #f #t #f #t #t #t #t #f #t #t #f)))
(test 28 (list->integer '(#f #t #t #t #f #f)))
(test 2 (list->integer '(#f #t #f)))
(test 1147 (list->integer '(#f #f #f #f #t #f #f #f #t #t #t #t #f #t #t)))
(test 293 (list->integer '(#f #f #f #f #f #t #f #f #t #f #f #t #f #t)))
(test 211 (list->integer '(#f #f #f #f #t #t #f #t #f #f #t #t)))
(test 26 (list->integer '(#t #t #f #t #f)))
(test 5 (list->integer '(#f #t #f #t)))
(test 238 (list->integer '(#f #f #f #t #t #t #f #t #t #t #f)))
(test 5 (list->integer '(#f #t #f #t)))
(test 3 (list->integer '(#t #t)))
(test 66 (list->integer '(#t #f #f #f #f #t #f)))
(test 3 (list->integer '(#t #t)))
(test 207 (list->integer '(#t #t #f #f #t #t #t #t)))
(test 0 (list->integer '(#f #f #f #f)))
(test 174 (list->integer '(#f #t #f #t #f #t #t #t #f)))
(test 15520 (list->integer '(#t #t #t #t #f #f #t #f #t #f #f #f #f #f)))
(test 433 (list->integer '(#t #t #f #t #t #f #f #f #t)))
(test 32310 (list->integer '(#t #t #t #t #t #t #f #f #f #t #t #f #t #t #f)))
(test 79 (list->integer '(#f #f #f #t #f #f #t #t #t #t)))
(test 19518 (list->integer '(#t #f #f #t #t #f #f #f #f #t #t #t #t #t #f)))
(test 1 (list->integer '(#t)))
(test 1 (list->integer '(#f #f #f #f #f #t)))
(test 11210 (list->integer '(#t #f #t #f #t #t #t #t #f #f #t #f #t #f)))
(test 7403 (list->integer '(#t #t #t #f #f #t #t #t #f #t #f #t #t)))
(test 1734 (list->integer '(#t #t #f #t #t #f #f #f #t #t #f)))
(test 378 (list->integer '(#t #f #t #t #t #t #f #t #f)))
(test 58 (list->integer '(#f #t #t #t #f #t #f)))
(test 1380 (list->integer '(#t #f #t #f #t #t #f #f #t #f #f)))
(test 28239 (list->integer '(#t #t #f #t #t #t #f #f #t #f #f #t #t #t #t)))
(test 0 (list->integer '(#f #f #f)))
(test 8320 (list->integer '(#t #f #f #f #f #f #t #f #f #f #f #f #f #f)))
(test 1 (list->integer '(#t)))
(test 1 (list->integer '(#t)))
(test 118 (list->integer '(#t #t #t #f #t #t #f)))
(test 2267 (list->integer '(#t #f #f #f #t #t #f #t #t #f #t #t)))
(test 6 (list->integer '(#t #t #f)))
(test 1 (list->integer '(#t)))
(test 86 (list->integer '(#t #f #t #f #t #t #f)))
(test 146 (list->integer '(#f #f #t #f #f #t #f #f #t #f)))
(test 136 (list->integer '(#f #f #f #t #f #f #f #t #f #f #f)))

(test-end)

(test-end)
